# Odd One Out Experiment
## Overview
This experiment is designed to identify the "odd one out" among a set of stimuli. It is implemented using PsychoPy and translated into JavaScript for use in online experiments via PsychoJS.

## Files
1. odd_one_out_experiment.js: Main JavaScript file generated by PsychoPy Builder.
2. odd_one_out_experiment.js: Main Python file generated by PsychoPy Builder.
3. odd_one_out_experiment.psyexp: PsychoPy Builder project.
4. index.html: HTML file to run the experiment in a browser. Also generated automatically by the PsychoPy builder.
5. clean_datafile.py: This file should be used to clean the datafile as generated by the PsychoPy builder or when hosted online.
5. data/: Output folder for local use. Online data will be collected through Pavlovia.
6. datasets/: Folder containing a .csv-file with all possible triplet combinations. The experiment uses a random sample from this dataset.
7. informed_consent/: Folder containing the informed consent image, KUL logo image, and a .doc file for text storage/adjustment. 
8. instructions/: folder containing an image of an example trial. 
9. lib/: Directory containing PsychoJS library files.
10. stimuli/: Directory containing all stimuli. 


## Setup and Execution
1. Server Setup: Ensure you have a web server set up, like Pavlovia, to host the experiment files. It can also be done locally using the PsychoPy builder.
2. Create a standalone root folder and put all files and directories here. Make sure there are no .git directories present here or in the parent folders.
3. Make sure to include any images or datasets you want to use with your project. You can include these in the "Additional Resources" using the PsychoPy Builder (Settings > Online tab > Additional Resources. Include files by pressing + button)
4. Using the 'Sync with web project' button in the PsychoPy builder you can log on to your Pavlovia account and create a repository. Once you are happy with your adjustments, you can push the complete directory for use in Pavlovia.
5. Alternatively, you can click 'run the study in PsychoJS on a local browser' to run the experiment locally in your browser.
6. It should also be able to run with Python using the regular PsychoPy execution button. This has not been tested well yet though. 

## Key Components
### Adjustable parameters
The experiment includes several adjustable parameters which can be modified to suit different experimental needs:

1. nPractice: The number of practice trials to be conducted before the main experiment begins. This helps participants familiarize themselves with the experiment format. The default value is 5.
2. nMain: The number of main trials to be conducted in the experiment. This represents the core of the experiment where actual data is collected. The default value is 50.
3. current_trial_type: A variable used to store the type of the current trial. It helps in categorizing the trials for data analysis. For example, it could be "practice" or "main".
4. current_event: A variable used to store the current event happening in the experiment. This is useful for detailed data logging and understanding participant behavior. For example, it could be "loading" or "click_response".

In the routine "start" you can find the first two parameters. The other ones are in the code blocks of each routine. 

### Key functions
The code includes several key custom functions that handle specific tasks within the experiment:

#### addTrialInfo
This function logs detailed information about each trial, including the trial type, event, reaction time, and time elapsed.

Parameters:
1. trial_type: The type of the current trial (e.g., "practice" or "main").
2. event: The current event happening in the trial (e.g., "loading", "click_response").
3. rt: Reaction time, measured in seconds.
4. time_elapsed: Time elapsed since the start of the experiment, measured in seconds.
5. index_count: The current trial index.

#### mouseOnStim
This function checks if the mouse is hovering over a specific stimulus. It is used to detect mouse interactions with stimuli.

Parameters:
1. stim: The stimulus object to check.
2. mouse: The mouse object.

#### logClickResponse
This function logs the response when the mouse clicks on a stimulus. It records details such as reaction time and the stimulus clicked.

Parameters:
1. mouseObject: The mouse object used to detect clicks.
2. trial_type: The type of the current trial.
3. trial_num: The current trial number.
4. time_elapsed: Time elapsed since the start of the experiment, measured in seconds.
5. trial_index: The current trial index.

### Informed consent
The informed consent is created manually by creating an image and displaying it during the start of the experiment. This is because the PsychoPy builder cannot handle formatted text in a text component.
One way to create an image is to adjust and copy the text in the .doc file and paste it on a grey background using a program like Microsoft Paint. Please also include a KU Leuven logo. Then export it to either .png or .jpg files. 

## Experiment Flow

1. Informed consent: Displays the informed consent form. Participant can accept by pressing the space bar, or exit the experiment using the escape key.
2. Welcome Screen: Displays an introduction to the experiment and waits for the participant to press the spacebar to continue.
3. Example Trial: Shows an example of the task, instructing the participant on how to select the "odd one out".
4. Practice Trials: Provides a set of practice trials to familiarize the participant with the task.
5. Main Experiment: Conducts the main set of trials where participants perform the actual task.
6. Exit Screen: Thanks the participants for their time and concludes the experiment.

## Important Note
When regenerating the JavaScript file from the PsychoPy Builder, it is essential to manually remove the line "var counter" (line 266) which the Builder automatically inserts. Not removing this line will cause double declaration errors in the experiment.

## Data Logging
The experiment logs various data points including trial type, events, reaction times, and mouse interactions. 
To make the data suitable for analysis, please clean the file first using the clean_datafile.py file. Since the datafile is generated using the PsychoPy Builder, there are some built-in datapoints that are redundant and hard to bypass. Cleaning the file will get rid of this. Make sure to put your datafile in a "data/" folder in the same root directory as the clean_datafile.py file. You can then run the script.

For more detailed information on how the experiment code works and to customize it further, refer to the full code and PsychoPy/PsychoJS documentation.

